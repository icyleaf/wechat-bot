require 'bundler/gem_tasks'
require 'rspec/core/rake_task'

require 'wechat_bot'
require 'awesome_print'

RSpec::Core::RakeTask.new(:spec)

task :default => :spec

desc 'Run a sample wechat bot'
task :bot do
  bot = WeChat::Bot.new
  bot.start
end

task :test do
  bot = WeChat::Bot.new
  list = WeChat::Bot::ContactList.new(bot)

  puts list.methods
  exit



  contacts = [{"Uin"=>0, "UserName"=>"filehelper", "NickName"=>"æ–‡ä»¶ä¼ è¾“åŠ©æ‰‹", "HeadImgUrl"=>"/cgi-bin/mmwebwx-bin/webwxgeticon?seq=645600992&username=filehelper&skey=@crypt_5f613f69_3f81c273144cb6d19ca014c87784e700", "ContactFlag"=>2, "MemberCount"=>0, "MemberList"=>[], "RemarkName"=>"", "HideInputBarFlag"=>0, "Sex"=>0, "Signature"=>"", "VerifyFlag"=>0, "OwnerUin"=>0, "PYInitial"=>"WJCSZS", "PYQuanPin"=>"wenjianchuanshuzhushou", "RemarkPYInitial"=>"", "RemarkPYQuanPin"=>"", "StarFriend"=>0, "AppAccountFlag"=>0, "Statues"=>0, "AttrStatus"=>0, "Province"=>"", "City"=>"", "Alias"=>"", "SnsFlag"=>0, "UniFriend"=>0, "DisplayName"=>"", "ChatRoomId"=>0, "KeyWord"=>"fil", "EncryChatRoomId"=>"", "IsOwner"=>0}, {"Uin"=>0, "UserName"=>"@ec7caaf5a6d34b1c6de5cbf712e9a5b7", "NickName"=>"çŽ‹å¡åŠ©æ‰‹", "HeadImgUrl"=>"/cgi-bin/mmwebwx-bin/webwxgeticon?seq=658640561&username=@ec7caaf5a6d34b1c6de5cbf712e9a5b7&skey=@crypt_5f613f69_3f81c273144cb6d19ca014c87784e700", "ContactFlag"=>3, "MemberCount"=>0, "MemberList"=>[], "RemarkName"=>"", "HideInputBarFlag"=>0, "Sex"=>0, "Signature"=>"â€œçŽ‹å¡â€äº§å“ä¸ºè”é€šå®šåˆ¶åŒ–äº§å“ï¼Œæ‚¨å¯ç•…äº«æŒ‡å®šAPPåº”ç”¨æµé‡å…è´¹ï¼Œå¥—é¤èµ„è´¹æ›´ä¼˜æƒ ï¼ŒçŽ‹å¡ç¦åˆ©ç¤¾ ç­‰å¤šé‡ç‰¹æƒï¼äº†è§£æ›´å¤šæƒŠå–œå°½åœ¨â€œçŽ‹å¡åŠ©æ‰‹â€ï¼Œæ›´å¤šç‰¹æƒç­‰ä½ æ¥å‘çŽ°ï¼", "VerifyFlag"=>24, "OwnerUin"=>0, "PYInitial"=>"WKZS", "PYQuanPin"=>"wangkazhushou", "RemarkPYInitial"=>"", "RemarkPYQuanPin"=>"", "StarFriend"=>0, "AppAccountFlag"=>0, "Statues"=>0, "AttrStatus"=>0, "Province"=>"å¹¿ä¸œ", "City"=>"æ·±åœ³", "Alias"=>"", "SnsFlag"=>0, "UniFriend"=>0, "DisplayName"=>"", "ChatRoomId"=>0, "KeyWord"=>"gh_", "EncryChatRoomId"=>"", "IsOwner"=>0}, {"Uin"=>0, "UserName"=>"filehelper", "NickName"=>"æ–‡ä»¶ä¼ è¾“åŠ©æ‰‹", "HeadImgUrl"=>"/cgi-bin/mmwebwx-bin/webwxgeticon?seq=645600992&username=filehelper&skey=@crypt_5f613f69_3f81c273144cb6d19ca014c87784e700", "ContactFlag"=>2, "MemberCount"=>0, "MemberList"=>[], "RemarkName"=>"", "HideInputBarFlag"=>0, "Sex"=>0, "Signature"=>"", "VerifyFlag"=>0, "OwnerUin"=>0, "PYInitial"=>"WJCSZS", "PYQuanPin"=>"wenjianchuanshuzhushou", "RemarkPYInitial"=>"", "RemarkPYQuanPin"=>"", "StarFriend"=>0, "AppAccountFlag"=>0, "Statues"=>0, "AttrStatus"=>0, "Province"=>"", "City"=>"", "Alias"=>"", "SnsFlag"=>0, "UniFriend"=>0, "DisplayName"=>"", "ChatRoomId"=>0, "KeyWord"=>"fil", "EncryChatRoomId"=>"", "IsOwner"=>0}, {"Uin"=>0, "UserName"=>"@0f4c761428a1b11156cc53ccbcd0c493", "NickName"=>"icyleaf<span class=\"emoji emoji1f37a\"></span>", "HeadImgUrl"=>"/cgi-bin/mmwebwx-bin/webwxgeticon?seq=620410039&username=@0f4c761428a1b11156cc53ccbcd0c493&skey=@crypt_5f613f69_3f81c273144cb6d19ca014c87784e700", "ContactFlag"=>65539, "MemberCount"=>0, "MemberList"=>[], "RemarkName"=>"", "HideInputBarFlag"=>0, "Sex"=>1, "Signature"=>"çˆ±å¥½æˆ·å¤–çš„ä»£ç ä»”ï¼Œä¸‹åŽ¨åˆå¿ƒè€…", "VerifyFlag"=>0, "OwnerUin"=>0, "PYInitial"=>"ICYLEAFSPANCLASSEMOJIEMOJI1F37ASPAN", "PYQuanPin"=>"icyleafspanclassemojiemoji1f37aspan", "RemarkPYInitial"=>"", "RemarkPYQuanPin"=>"", "StarFriend"=>0, "AppAccountFlag"=>0, "Statues"=>0, "AttrStatus"=>37986725, "Province"=>"Rotterdam", "City"=>"", "Alias"=>"", "SnsFlag"=>49, "UniFriend"=>0, "DisplayName"=>"", "ChatRoomId"=>0, "KeyWord"=>"icy", "EncryChatRoomId"=>"", "IsOwner"=>0}]

  contacts.each do |c|
    user = WeChat::Bot::Contact.parse(c, bot)
    puts "[#{user.kind}] #{user.nickname} - #{user.username}"
  end

  all = {"BaseResponse"=>{"Ret"=>0, "ErrMsg"=>""}, "MemberCount"=>6, "MemberList"=>[{"Uin"=>0, "UserName"=>"weixin", "NickName"=>"å¾®ä¿¡å›¢é˜Ÿ", "HeadImgUrl"=>"/cgi-bin/mmwebwx-bin/webwxgeticon?seq=500002&username=weixin&skey=@crypt_5f613f69_3f81c273144cb6d19ca014c87784e700", "ContactFlag"=>1, "MemberCount"=>0, "MemberList"=>[], "RemarkName"=>"", "HideInputBarFlag"=>0, "Sex"=>0, "Signature"=>"å¾®ä¿¡å›¢é˜Ÿå®˜æ–¹å¸å·", "VerifyFlag"=>56, "OwnerUin"=>0, "PYInitial"=>"WXTD", "PYQuanPin"=>"weixintuandui", "RemarkPYInitial"=>"", "RemarkPYQuanPin"=>"", "StarFriend"=>0, "AppAccountFlag"=>0, "Statues"=>0, "AttrStatus"=>4, "Province"=>"", "City"=>"", "Alias"=>"", "SnsFlag"=>0, "UniFriend"=>0, "DisplayName"=>"", "ChatRoomId"=>0, "KeyWord"=>"wei", "EncryChatRoomId"=>"", "IsOwner"=>0}, {"Uin"=>0, "UserName"=>"@f4eaa88ed1f5b2a0a0c33b4c01e8368f", "NickName"=>"obinså¤–è®¾", "HeadImgUrl"=>"/cgi-bin/mmwebwx-bin/webwxgeticon?seq=639310140&username=@f4eaa88ed1f5b2a0a0c33b4c01e8368f&skey=@crypt_5f613f69_3f81c273144cb6d19ca014c87784e700", "ContactFlag"=>3, "MemberCount"=>0, "MemberList"=>[], "RemarkName"=>"", "HideInputBarFlag"=>0, "Sex"=>0, "Signature"=>"obinså·¥ç¨‹å¸ˆå›¢é˜Ÿä¸ºæ‚¨æ‰“é€ çš„ä¸“ä¸šå¤–è®¾å“ç‰Œï¼", "VerifyFlag"=>24, "OwnerUin"=>0, "PYInitial"=>"OBINSWS", "PYQuanPin"=>"obinswaishe", "RemarkPYInitial"=>"", "RemarkPYQuanPin"=>"", "StarFriend"=>0, "AppAccountFlag"=>0, "Statues"=>0, "AttrStatus"=>0, "Province"=>"æ±Ÿè‹", "City"=>"è‹å·ž", "Alias"=>"", "SnsFlag"=>0, "UniFriend"=>0, "DisplayName"=>"", "ChatRoomId"=>0, "KeyWord"=>"gh_", "EncryChatRoomId"=>"", "IsOwner"=>0}, {"Uin"=>0, "UserName"=>"@3202677ee97ceba886b9b1410bc0b732", "NickName"=>"QQå®‰å…¨ä¸­å¿ƒ", "HeadImgUrl"=>"/cgi-bin/mmwebwx-bin/webwxgeticon?seq=631620302&username=@3202677ee97ceba886b9b1410bc0b732&skey=@crypt_5f613f69_3f81c273144cb6d19ca014c87784e700", "ContactFlag"=>3, "MemberCount"=>0, "MemberList"=>[], "RemarkName"=>"", "HideInputBarFlag"=>0, "Sex"=>0, "Signature"=>"QQå®‰å…¨ä¸­å¿ƒå®˜æ–¹å¾®ä¿¡ã€‚åŠªåŠ›ä¿æŠ¤æ‚¨çš„QQå®‰å…¨ï¼Œå…³é”®æ—¶åˆ»åŠæ—¶æé†’ï¼Œéšæ—¶æŽŒæ¡å¸å·å®‰å…¨åŠ¨æ€ã€‚", "VerifyFlag"=>24, "OwnerUin"=>0, "PYInitial"=>"QQAQZX", "PYQuanPin"=>"QQanquanzhongxin", "RemarkPYInitial"=>"", "RemarkPYQuanPin"=>"", "StarFriend"=>0, "AppAccountFlag"=>0, "Statues"=>0, "AttrStatus"=>0, "Province"=>"å¹¿ä¸œ", "City"=>"æ·±åœ³", "Alias"=>"", "SnsFlag"=>0, "UniFriend"=>0, "DisplayName"=>"", "ChatRoomId"=>0, "KeyWord"=>"qqs", "EncryChatRoomId"=>"", "IsOwner"=>0}, {"Uin"=>0, "UserName"=>"@0f4c761428a1b11156cc53ccbcd0c493", "NickName"=>"icyleaf<span class=\"emoji emoji1f37a\"></span>", "HeadImgUrl"=>"/cgi-bin/mmwebwx-bin/webwxgeticon?seq=620410039&username=@0f4c761428a1b11156cc53ccbcd0c493&skey=@crypt_5f613f69_3f81c273144cb6d19ca014c87784e700", "ContactFlag"=>65539, "MemberCount"=>0, "MemberList"=>[], "RemarkName"=>"", "HideInputBarFlag"=>0, "Sex"=>1, "Signature"=>"çˆ±å¥½æˆ·å¤–çš„ä»£ç ä»”ï¼Œä¸‹åŽ¨åˆå¿ƒè€…", "VerifyFlag"=>0, "OwnerUin"=>0, "PYInitial"=>"ICYLEAFSPANCLASSEMOJIEMOJI1F37ASPAN", "PYQuanPin"=>"icyleafspanclassemojiemoji1f37aspan", "RemarkPYInitial"=>"", "RemarkPYQuanPin"=>"", "StarFriend"=>0, "AppAccountFlag"=>0, "Statues"=>0, "AttrStatus"=>37986725, "Province"=>"Rotterdam", "City"=>"", "Alias"=>"", "SnsFlag"=>49, "UniFriend"=>0, "DisplayName"=>"", "ChatRoomId"=>0, "KeyWord"=>"icy", "EncryChatRoomId"=>"", "IsOwner"=>0}, {"Uin"=>0, "UserName"=>"@5957231a28bf59dd36ca0699fa393eaa", "NickName"=>"é™ˆè€å®… ðŸ•", "HeadImgUrl"=>"/cgi-bin/mmwebwx-bin/webwxgeticon?seq=658640520&username=@5957231a28bf59dd36ca0699fa393eaa&skey=@crypt_5f613f69_3f81c273144cb6d19ca014c87784e700", "ContactFlag"=>3, "MemberCount"=>0, "MemberList"=>[], "RemarkName"=>"", "HideInputBarFlag"=>0, "Sex"=>0, "Signature"=>"æˆ‘åšè¿‡å¾ˆå¤šäº‹ï¼Œæ¯ä¸€ä»¶éƒ½æ˜¯å–œæ¬¢çš„ã€‚", "VerifyFlag"=>0, "OwnerUin"=>0, "PYInitial"=>"CLZ?", "PYQuanPin"=>"chenlaozhai?", "RemarkPYInitial"=>"", "RemarkPYQuanPin"=>"", "StarFriend"=>0, "AppAccountFlag"=>0, "Statues"=>0, "AttrStatus"=>33654783, "Province"=>"", "City"=>"", "Alias"=>"", "SnsFlag"=>49, "UniFriend"=>0, "DisplayName"=>"", "ChatRoomId"=>0, "KeyWord"=>"nic", "EncryChatRoomId"=>"", "IsOwner"=>0}, {"Uin"=>0, "UserName"=>"@ec7caaf5a6d34b1c6de5cbf712e9a5b7", "NickName"=>"çŽ‹å¡åŠ©æ‰‹", "HeadImgUrl"=>"/cgi-bin/mmwebwx-bin/webwxgeticon?seq=658640561&username=@ec7caaf5a6d34b1c6de5cbf712e9a5b7&skey=@crypt_5f613f69_3f81c273144cb6d19ca014c87784e700", "ContactFlag"=>3, "MemberCount"=>0, "MemberList"=>[], "RemarkName"=>"", "HideInputBarFlag"=>0, "Sex"=>0, "Signature"=>"â€œçŽ‹å¡â€äº§å“ä¸ºè”é€šå®šåˆ¶åŒ–äº§å“ï¼Œæ‚¨å¯ç•…äº«æŒ‡å®šAPPåº”ç”¨æµé‡å…è´¹ï¼Œå¥—é¤èµ„è´¹æ›´ä¼˜æƒ ï¼ŒçŽ‹å¡ç¦åˆ©ç¤¾ ç­‰å¤šé‡ç‰¹æƒï¼äº†è§£æ›´å¤šæƒŠå–œå°½åœ¨â€œçŽ‹å¡åŠ©æ‰‹â€ï¼Œæ›´å¤šç‰¹æƒç­‰ä½ æ¥å‘çŽ°ï¼", "VerifyFlag"=>24, "OwnerUin"=>0, "PYInitial"=>"WKZS", "PYQuanPin"=>"wangkazhushou", "RemarkPYInitial"=>"", "RemarkPYQuanPin"=>"", "StarFriend"=>0, "AppAccountFlag"=>0, "Statues"=>0, "AttrStatus"=>0, "Province"=>"å¹¿ä¸œ", "City"=>"æ·±åœ³", "Alias"=>"", "SnsFlag"=>0, "UniFriend"=>0, "DisplayName"=>"", "ChatRoomId"=>0, "KeyWord"=>"gh_", "EncryChatRoomId"=>"", "IsOwner"=>0}], "Seq"=>0}
  all["MemberList"].each do |c|
    user = WeChat::Bot::Contact.parse(c, bot)
    puts "[#{user.kind}] #{user.nickname} - #{user.username}"
  end
end
